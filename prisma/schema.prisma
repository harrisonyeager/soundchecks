  generator client {
    provider = "prisma-client-js"
  }

  datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
  }

  model Profile {
    id        String   @id @default(cuid())
    clerkId   String   @unique
    username  String   @unique
    email     String
    bio       String?
    imageUrl  String?
    
    logs      ConcertLog[]
    followers Follow[]  @relation("follower")
    following Follow[]  @relation("following")
    
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
  }

  model ConcertLog {
    id        String   @id @default(cuid())
    profileId String
    profile   Profile  @relation(fields: [profileId], references: [id], onDelete: Cascade)
    
    // Start simple - we'll normalize later
    artist    String
    venue     String
    city      String
    date      DateTime
    rating    Float?
    notes     String?
    
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    
    @@index([profileId])
    @@index([date])
  }

  model Follow {
    id          String   @id @default(cuid())
    followerId  String
    follower    Profile  @relation("follower", fields: [followerId], references: [id], onDelete: Cascade)
    followingId String
    following   Profile  @relation("following", fields: [followingId], references: [id], onDelete: Cascade)
    
    createdAt   DateTime @default(now())
    
    @@unique([followerId, followingId])
    @@index([followerId])
    @@index([followingId])
  }